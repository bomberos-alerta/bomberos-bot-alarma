from telegram import InlineKeyboardButton, InlineKeyboardMarkup, Update
from telegram.ext import ApplicationBuilder, CallbackQueryHandler, CommandHandler, ContextTypes
import asyncio

# TOKEN del bot
TOKEN = '7584566617:AAGnPIj_B49dFMAD4jNFQae30o479PGYADI'

# ID del grupo de Telegram
CHAT_ID = -1002744372098

# Botones de emergencia
emergencias = [
    ("ğŸš— Accidente vehicular", "accidente"),
    ("ğŸ  Incendio estructural", "estructural"),
    ("ğŸŒ² Incendio forestal", "forestal"),
    ("ğŸ’¨ Fuga de gas", "gas"),
    ("ğŸ§­ BÃºsqueda de personas", "busqueda"),
    ("ğŸ¾ Rescate animal", "animal"),
    ("â— Otra emergencia", "otra")
]

# Crear botones
def crear_botones():
    return InlineKeyboardMarkup([
        [InlineKeyboardButton(text, callback_data=code)] for text, code in emergencias
    ])

# Comando /start: muestra los botones
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await context.bot.send_message(
        chat_id=CHAT_ID,
        text="ğŸš¨ *SeleccionÃ¡ el tipo de emergencia:*",
        reply_markup=crear_botones(),
        parse_mode='Markdown'
    )

# Al presionar un botÃ³n
async def boton_presionado(update: Update, context: ContextTypes.DEFAULT_TYPE):
    query = update.callback_query
    await query.answer()

    tipo = query.data
    usuario = query.from_user.first_name

    mensajes = {
        "accidente": "ğŸš— *Â¡ALERTA! Accidente vehicular!*",
        "estructural": "ğŸ  *Â¡ALERTA! Incendio estructural!*",
        "forestal": "ğŸŒ² *Â¡ALERTA! Incendio forestal!*",
        "gas": "ğŸ’¨ *Â¡ALERTA! Fuga de gas!*",
        "busqueda": "ğŸ§­ *Â¡ALERTA! BÃºsqueda de personas!*",
        "animal": "ğŸ¾ *Â¡ALERTA! Rescate animal!*",
        "otra": "â— *Â¡ALERTA! Otra emergencia!*"
    }

    texto_alerta = f"{mensajes.get(tipo, 'ğŸš¨ *Emergencia desconocida*')}\nğŸ‘¤ Reportado por: *{usuario}*"

    await context.bot.send_message(
        chat_id=CHAT_ID,
        text=texto_alerta,
        parse_mode='Markdown'
    )

    await asyncio.sleep(1)

    await context.bot.send_message(
        chat_id=CHAT_ID,
        text="ğŸ” *Â¿Otra emergencia? SeleccionÃ¡ nuevamente:*",
        reply_markup=crear_botones(),
        parse_mode='Markdown'
    )

# Iniciar bot
if __name__ == '__main__':
    app = ApplicationBuilder().token(TOKEN).build()
    app.add_handler(CommandHandler('start', start))
    app.add_handler(CallbackQueryHandler(boton_presionado))
    app.run_polling()
~ $
